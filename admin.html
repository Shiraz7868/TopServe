<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Admin Panel - TopServe</title><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
:root { /* ... (Poora CSS pichle jawab se) ... */ }
html, body { /* ... */ }
body { /* ... */ }
.container { max-width: 900px !important; /* ... */ }
h1, h2, label, input, button { /* ... */ }
.card { /* ... */ }
.admin-grid { display: grid; grid-template-columns: 1fr; gap: 25px; }
@media (min-width: 992px) { .admin-grid { grid-template-columns: 1fr 1fr; } }
.user-management { display: grid; grid-template-columns: 2fr 1fr auto; gap: 15px; align-items: flex-end; }
.order-list { list-style: none; padding: 0; max-height: 50vh; overflow-y: auto; }
.order-item { background: #3b4b64; padding: 15px; border-radius: 8px; margin-bottom: 10px; }
.deposit-request-item .screenshot-image { max-width: 150px; border-radius: 4px; cursor: pointer; margin-top: 10px; }
@media (max-width: 768px) { /* ... */ }
</style></head><body>
<div class="container admin-container">
    <h1>Admin Panel</h1>
    <div class="admin-grid">
        <div class="card">
            <h2>Pending Deposit Requests</h2>
            <ul id="deposit-requests-list" class="order-list"><li>Loading...</li></ul>
        </div>
        <div class="card">
            <h2>All Pending Orders</h2>
            <ul id="admin-order-list" class="order-list"><li>Loading...</li></ul>
        </div>
    </div>
    <div class="card">
        <h2>Manage User Balance (Manual)</h2>
        <div class="user-management">
            <!-- ... (Manual Balance HTML) ... -->
        </div>
    </div>
</div>
<script>
    const SUPABASE_URL = 'https://lyqdnxaxisnipeogtzfm.supabase.co';
    // === YAHAN APNI SECRET SERVICE_ROLE KEY PASTE KAREIN ===
    const SUPABASE_SERVICE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx5cWRueGF4aXNuaXBlb2d0emZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE2MDA5NzEsImV4cCI6MjA2NzE3Njk3MX0.RLhRacgqtvXk2-qaQ3ZCLYkcshg5_kIN5Mko6WMouWw'; 
    const supabaseAdmin = supabase.createClient(SUPABASE_URL, SUPABASE_SERVICE_KEY);
    
    async function loadDepositRequests() {
        const list = document.getElementById('deposit-requests-list');
        const { data, error } = await supabaseAdmin.from('deposit_requests').select(`*, profile:profiles(username)`).eq('status', 'Pending').order('created_at');
        if (error) { list.innerHTML = '<li>Error loading requests.</li>'; return; }
        if (!data || data.length === 0) { list.innerHTML = '<li>No pending deposit requests.</li>'; return; }
        list.innerHTML = data.map(req => `
            <li class="deposit-request-item">
                User: <strong>${req.profile ? req.profile.username : 'N/A'}</strong> | Amount: <strong>${req.amount} PKR</strong><br>
                Method: ${req.method} | Sender: ${req.sender_number}<br>
                <img src="${req.screenshot_base64}" alt="Screenshot" class="screenshot-image" onclick="window.open(this.src, '_blank')">
                <div style="margin-top:15px; display:flex; gap:10px;">
                    <button class="approve-btn" data-req-id="${req.id}" data-user-id="${req.user_id}" data-amount="${req.amount}" style="background:var(--secondary-color);">Approve</button>
                    <button class="reject-btn" data-req-id="${req.id}" style="background:var(--danger-color);">Reject</button>
                </div>
            </li>`).join('');
    }
    // ... (Baqi ka poora admin.html ka JavaScript pichle jawabon se)
</script></body></html>
